<p><em>Analyze your Tableau log files – in Tableau!</em></p>

<p>Logshark is a tool you can use to analyze and troubleshoot Tableau performance and activity. Logshark extracts data from Tableau Server and Tableau Desktop log files and builds workbooks that can help you identify and understand error conditions, performance bottlenecks, and background activity. Logshark works by running a set of targeted plugins that pull specific data out of the log files. Logshark builds a data source and provides Tableau workbooks which you can then use to analyze the log files in Tableau.</p>

<!--
[Second page](/Logshark/second-page).
-->

<p>In this section:</p>

<ul id="markdown-toc">
  <li><a href="#logshark-and-tableau-technical-support" id="markdown-toc-logshark-and-tableau-technical-support">Logshark and Tableau Technical Support</a></li>
  <li><a href="#get-your-computer-set-up-for-logshark" id="markdown-toc-get-your-computer-set-up-for-logshark">Get your computer set up for Logshark</a>    <ul>
      <li><a href="#system-requirements" id="markdown-toc-system-requirements">System Requirements</a></li>
      <li><a href="#tableau-archive-log-requirements" id="markdown-toc-tableau-archive-log-requirements">Tableau Archive Log Requirements</a></li>
    </ul>
  </li>
  <li><a href="#install-and-configure-postgresql" id="markdown-toc-install-and-configure-postgresql">Install and Configure PostgreSQL</a>    <ul>
      <li><a href="#download-and-install-postgresql" id="markdown-toc-download-and-install-postgresql">Download and Install PostgreSQL</a></li>
      <li><a href="#configure-postgresql-for-logshark" id="markdown-toc-configure-postgresql-for-logshark">Configure PostgreSQL for Logshark</a>        <ul>
          <li><a href="#create-a-login-role-for-logshark" id="markdown-toc-create-a-login-role-for-logshark">Create a Login Role for Logshark</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#install-logshark" id="markdown-toc-install-logshark">Install Logshark</a>    <ul>
      <li><a href="#run-the-logshark-setup-program" id="markdown-toc-run-the-logshark-setup-program">Run the Logshark Setup program</a></li>
    </ul>
  </li>
  <li><a href="#configure-logshark" id="markdown-toc-configure-logshark">Configure Logshark</a>    <ul>
      <li><a href="#edit-the-postgresql-connection-information-in-logsharkconfig" id="markdown-toc-edit-the-postgresql-connection-information-in-logsharkconfig">Edit the PostgreSQL connection information in Logshark.config</a></li>
      <li><a href="#edit-the-tableau-server-connection-information-in-logsharkconfig" id="markdown-toc-edit-the-tableau-server-connection-information-in-logsharkconfig">Edit the Tableau Server connection information in Logshark.config</a></li>
    </ul>
  </li>
  <li><a href="#running-logshark-and-viewing-the-results" id="markdown-toc-running-logshark-and-viewing-the-results">Running Logshark and Viewing the Results</a>    <ul>
      <li><a href="#run-logshark-to-process-the-log-files" id="markdown-toc-run-logshark-to-process-the-log-files">Run Logshark to process the log files</a></li>
      <li><a href="#view-the-generated-tableau-workbooks" id="markdown-toc-view-the-generated-tableau-workbooks">View the generated Tableau workbooks:</a></li>
    </ul>
  </li>
  <li><a href="#remove-logshark-installation" id="markdown-toc-remove-logshark-installation">Remove Logshark Installation</a>    <ul>
      <li><a href="#uninstall-logshark" id="markdown-toc-uninstall-logshark">Uninstall Logshark</a></li>
      <li><a href="#remove-postgresql-files" id="markdown-toc-remove-postgresql-files">Remove PostgreSQL files.</a></li>
    </ul>
  </li>
  <li><a href="#logshark-reference" id="markdown-toc-logshark-reference">Logshark Reference</a>    <ul>
      <li><a href="#logshark-command-options" id="markdown-toc-logshark-command-options">Logshark command options</a></li>
      <li><a href="#logshark-plugins-and-generated-workbooks" id="markdown-toc-logshark-plugins-and-generated-workbooks">Logshark plugins and generated workbooks</a></li>
      <li><a href="#adding-your-own-custom-workbooks" id="markdown-toc-adding-your-own-custom-workbooks">Adding your own custom workbooks</a></li>
      <li><a href="#appending-logshark-generated-data-to-the-same-workbook" id="markdown-toc-appending-logshark-generated-data-to-the-same-workbook">Appending Logshark-generated data to the same workbook</a></li>
      <li><a href="#use-your-own-mongodb-instance" id="markdown-toc-use-your-own-mongodb-instance">Use your own MongoDB instance</a></li>
    </ul>
  </li>
</ul>

<h1 id="logshark-and-tableau-technical-support">Logshark and Tableau Technical Support</h1>

<p>Logshark is made available AS-IS with <strong>no</strong> support from Tableau Technical Support. This is intended to be a self-service tool and includes this user guide. Any bugs discovered should be filed in the <a href="https://github.com/tableau/Logshark/issues">Logshark Git Issue tracker</a>.</p>

<h1 id="get-your-computer-set-up-for-logshark">Get your computer set up for Logshark</h1>

<p>Before you install and run Logshark on your computer, review the following <a href="#system-requirements">System Requirements</a> and <a href="#tableau-archive-log-requirements">Tableau Archive Log Requirements</a>.</p>

<h2 id="system-requirements">System Requirements</h2>

<ul>
  <li>
    <p>A computer running a 64-bit version of Windows (2008 R2 or later).</p>
  </li>
  <li>
    <p>An account with local administrator permissions on the computer where you will be installing Logshark.</p>
  </li>
  <li>
    <p>.NET Framework 4.5.1 installed (or later versions). The Logshark setup program checks for the correct version of the .NET Framework and automatically installs it if necessary.</p>
  </li>
  <li>
    <p>For best performance, use a computer with the latest hardware and software available. The ability of Logshark to process log files improves as the performance of the computer’s CPU, Memory and Disk I/O increases.</p>
  </li>
  <li>
    <p>Tableau Desktop version 9.3 (or later) to view workbooks. You can download Tableau from: <a href="http://www.tableau.com/products/desktop">http://www.tableau.com/products/desktop</a></p>
  </li>
  <li>
    <p>MongoDB – a standalone instance is included with the Logshark installation. Logshark uses MongoDB when it is extracting data from the log files. In most cases, you can specify a command option to tell Logshark to utilize the local instance of MongoDB for processing.</p>

    <ul>
      <li>
        <p>However, if you have large log files (greater than 2 GB) the recommendation is that you use a MongoDB instance located on another computer to minimize contention.</p>
      </li>
      <li>
        <p>You can Download MongoDB Community Server at: <a href="https://www.mongodb.com/download-center#community">https://www.mongodb.com/download-center#community</a>. To configure it, see <a href="#use-your-own-mongodb-instance">Use your own MongoDB instance.</a></p>
      </li>
    </ul>
  </li>
  <li>
    <p>PostgreSQL – Logshark requires a PostgreSQL database as the backing data source for the workbooks that analyze the Tableau log files. PostgreSQL is not included in the Logshark installation. To use Logshark, you need to download and install PostgreSQL (version 9.5 or later) on your computer. <a href="https://www.postgresql.org/">https://www.postgresql.org/</a>. As with MongoDB, for best performance on very large log files, we recommend that you install PostgreSQL on a separate computer.</p>

    <ul>
      <li><strong>NOTE:</strong> Do <strong>NOT</strong> use your Tableau Server repository for Logshark or any other existing PostgreSQL instance. Logshark needs to have its own PostgreSQL to store data.</li>
    </ul>
  </li>
</ul>

<h2 id="tableau-archive-log-requirements">Tableau Archive Log Requirements</h2>

<p>The archive log files must be from Tableau Server or Tableau Desktop version 9.0 or later. Logshark requires that the Tableau Server log files that you process are compressed (zipped) files, also known as <em>archive</em> files or <em>snapshots</em>.</p>

<p>You can create these archive files using the <code class="highlighter-rouge">tabadmin ziplogs</code> command on the Tableau Server, or by creating a snapshot from the Status or Maintenance menu within Tableau Server. For more information about gathering Tableau Server log files, see <a href="http://onlinehelp.tableau.com/current/server/en-us/logs_create.htm">Archive Log Files</a>.</p>

<p>For Tableau Desktop, the log files are located in the <strong>My Tableau Repository</strong> directory. The default location is <code class="highlighter-rouge">\Users\</code><em>&lt;username&gt;</em><code class="highlighter-rouge">\Documents\My Tableau Repository\Logs</code>. You can also find the location using Tableau. Start Tableau Desktop and click <strong>File &gt; Repository</strong> <strong>Location</strong>.</p>

<p>After you locate the log files, you can copy them to another location to process, or specify the path to their current location when you run Logshark.</p>

<h1 id="install-and-configure-postgresql">Install and Configure PostgreSQL</h1>

<p>Use the following instructions to manually install PostgreSQL on your computer. Logshark needs to have its own PostgreSQL instance to store data. If you are using PostgreSQL on a remote computer, that is, not on the local computer running Logshark, you need to do a few additional steps to allow the remote connection. By default, PostgreSQL does not allow any remote connections.</p>

<h2 id="download-and-install-postgresql">Download and Install PostgreSQL</h2>

<ul>
  <li>
    <p>Download PostgreSQL
<a href="http://www.enterprisedb.com/products-services-training/pgdownload">http://www.enterprisedb.com/products-services-training/pgdownload#bwindows</a></p>
  </li>
  <li>
    <p>Run the installer and configure the following options into the setup wizard:</p>

    <ul>
      <li>
        <p>For the (<strong>postgres</strong>) superuser password: &lt;<em>your choice&gt;</em></p>
      </li>
      <li>
        <p>Port: <strong>5432</strong></p>
      </li>
      <li>
        <p>Locale: English, United States</p>
      </li>
      <li>
        <p>If prompted to launch StackBuilder, choose <strong>No</strong>.</p>
      </li>
    </ul>
  </li>
</ul>

<h2 id="configure-postgresql-for-logshark">Configure PostgreSQL for Logshark</h2>

<p>The following instructions describe how to configure your PostgreSQL installation for Logshark.</p>

<h3 id="create-a-login-role-for-logshark">Create a Login Role for Logshark</h3>

<ol>
  <li>
    <p>Open pgAdmin (III or 4), the PostgreSQL administration tool.</p>
  </li>
  <li>
    <p>Connect to the PostgreSQL server using the superuser (<strong>postgres</strong>) login account.</p>
  </li>
  <li>
    <p>Right click on <strong>Login Roles</strong> (or Login/Group Role) and choose <strong>New Login Role…</strong></p>
  </li>
</ol>

<p><img src="./assets/postgres-login-role.png" width="273" height="160" /></p>

<ol>
  <li>
    <p>In the New Login Role dialog box, enter the following values:
Role name: <strong>logshark</strong>
Password: <strong>logshark</strong> (on the Definition tab).</p>

    <p>Role privileges: Select the <strong>Can create databases</strong> and <strong>Can login</strong> options.</p>
  </li>
  <li>
    <p>(Optional) If you installed PostgreSQL on a remote computer (not on the computer running Logshark), you need to add a pg_hba.conf entry to enable a connection. See instructions for this at <a href="https://www.postgresql.org/docs/current/static/auth-pg-hba-conf.html.">https://www.postgresql.org/docs/current/static/auth-pg-hba-conf.html.
</a></p>
  </li>
</ol>

<h1 id="install-logshark">Install Logshark</h1>

<p>If you have not done so already, you need to run the Logshark Setup program. If you need to uninstall or re-install Logshark, you should follow the <a href="#uninstall-logshark">Uninstall Logshark</a> instructions.</p>

<h2 id="run-the-logshark-setup-program">Run the Logshark Setup program</h2>

<ol>
  <li>
    <p>From the directory where you downloaded Logshark, run the Logshark Setup program, double-click the file <code class="highlighter-rouge">Setup_Logshark_v1.0.exe</code>.</p>
  </li>
  <li>
    <p>Click <strong>Install</strong> to use the default configuration. This adds Logshark to the PATH environment variable.</p>
  </li>
</ol>

<ul>
  <li>Click <strong>Options</strong> if you need to change the default installation directory (from <code class="highlighter-rouge">C:\Program Files\Logshark</code>).</li>
</ul>

<p><strong>NOTE:</strong> The archive logs will need to be unzipped or copied to the drive where you have installed Logshark. If your <code class="highlighter-rouge">C:\</code> drive is low on space, you should install Logshark in a different location.</p>

<h1 id="configure-logshark">Configure Logshark</h1>

<p>Logshark uses a configuration file to point to the databases that are used for parsing and storing log data. The configuration file also lets you publish the Tableau workbooks to a specific Tableau Server. This configuration is located at <em>&lt;install_directory&gt;</em><code class="highlighter-rouge">\Config\Logshark.config</code>.</p>

<p>Some of these configuration settings can be overridden at the command line. Other settings can only be set in the configuration file. For example, if you want to specify which Tableau Server to use when publishing workbooks, you need to set that option in the configuration file.</p>

<p><strong>NOTE:</strong> To be able to publish workbooks to Tableau Server, the REST API option (<code class="highlighter-rouge">api.server.enabled</code>) must be enabled. See the <a href="https://onlinehelp.tableau.com/current/api/rest_api/en-us/help.htm#REST/rest_api_requ.htm%3FTocPath%3D_____3">REST API Requirements</a> article for more details.</p>

<h2 id="edit-the-postgresql-connection-information-in-logsharkconfig">Edit the PostgreSQL connection information in Logshark.config</h2>

<ol>
  <li>
    <p>In a text editor, open the configuration file: <em>&lt;install_directory&gt;</em><code class="highlighter-rouge">\Config\Logshark.config</code> file. In the Logshark.config file, change the <code class="highlighter-rouge">&lt;PostgresConnection&gt;</code> settings to match your PostgreSQL setup.</p>
  </li>
  <li>
    <p>Set the Server <code class="highlighter-rouge">address</code> attribute to the name of the computer that is running PostgreSQL. For example, if you have installed PostgreSQL on your local computer, use <strong>localhost</strong> as the address.</p>
  </li>
  <li>
    <p>Set the <code class="highlighter-rouge">port</code> attribute to the port your server uses if it is different from the default. The default port is <strong>5432</strong>.</p>
  </li>
  <li>
    <p>For the <code class="highlighter-rouge">user</code>, set both the <code class="highlighter-rouge">username</code> and <code class="highlighter-rouge">password</code> to <strong>logshark</strong> to match the role/user and password you added when you <a href="#configure-postgresql-for-logshark">Configure PostgreSQL for Logshark</a>.</p>
  </li>
</ol>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>    ...
    <span class="nt">&lt;PostgresConnection&gt;</span>
       <span class="nt">&lt;Server</span> <span class="na">address=</span><span class="s">"localhost"</span> <span class="na">port=</span><span class="s">"5432"</span><span class="nt">/&gt;</span>
       <span class="nt">&lt;User</span> <span class="na">username=</span><span class="s">"logshark"</span> <span class="na">password=</span><span class="s">"logshark"</span><span class="nt">/&gt;</span>
     <span class="nt">&lt;/PostgresConnection&gt;</span>
     ...
</code></pre>
</div>

<ol>
  <li>
    <p>Save the file.</p>

    <p><strong>NOTE:</strong> You only need to edit the MongoDB connection information if you plan to use your own MongoDB installation to store the log data (recommended if logs are greater than 2GB). In most cases, you want to use the MongoDB instance that Logshark provides (using the <code class="highlighter-rouge">--startlocalmongo</code> command line option, or by setting <code class="highlighter-rouge">LocalMongoOptions useAlways="true"</code> in the config). For more information, see <a href="#use-your-own-mongodb-instance">Use your own MongoDB instance</a>.</p>
  </li>
</ol>

<h2 id="edit-the-tableau-server-connection-information-in-logsharkconfig">Edit the Tableau Server connection information in Logshark.config</h2>

<p>If you want to publish the workbooks that Logshark generates on Tableau Server, change the <code class="highlighter-rouge">&lt;TableauConnection&gt;</code> settings in the Logshark.config file to match your Tableau Server configuration.</p>

<p>When you edit the Tableau Server connection, follow these guidelines:</p>

<ul>
  <li>
    <p>The Server <code class="highlighter-rouge">address</code> attribute should just contain the hostname or IP address of the computer (for example, <em>mytableauserver.tableau.com</em>), and should not be prefixed with the protocol (<em>http or https</em>).</p>
  </li>
  <li>
    <p>When using a non-standard port for your Tableau Server, ensure the <code class="highlighter-rouge">port</code> attribute is set correctly (by default, HTTP uses port <strong>80</strong> and HTTPS uses port <strong>443</strong>).</p>
  </li>
  <li>
    <p>The <code class="highlighter-rouge">site</code> attribute cannot be blank. If you are using the default site (for example, <code class="highlighter-rouge">http://localhost/#</code>), specify <strong>Default</strong> as the name (<code class="highlighter-rouge">site="Default"</code>).</p>
  </li>
  <li>
    <p>To publish workbooks, the user account you specify must exist on the Tableau Server (and the site) with Publisher permissions and the permissions to create projects. (<em>Site Administrator role will be the easiest option</em>).</p>
  </li>
</ul>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>...

<span class="nt">&lt;TableauConnection</span> <span class="na">protocol=</span><span class="s">"http"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Server</span> <span class="na">address=</span><span class="s">"myTableauServer"</span> <span class="na">port=</span><span class="s">"80"</span> <span class="na">site=</span><span class="s">"MySite"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;User</span> <span class="na">username=</span><span class="s">"myUser"</span> <span class="na">password=</span><span class="s">"myUserPassword"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/TableauConnection&gt;</span>
 ...

</code></pre>
</div>

<h1 id="running-logshark-and-viewing-the-results">Running Logshark and Viewing the Results</h1>

<p>After you set up PostgreSQL and install and configure Logshark, the rest is easy.</p>

<h2 id="run-logshark-to-process-the-log-files">Run Logshark to process the log files</h2>

<ol>
  <li>
    <p>Open a Command Prompt window as administrator.</p>
  </li>
  <li>
    <p>Run <code class="highlighter-rouge">Setup_Logshark_v1.0.exe</code> and specify the path to the Tableau archive and any other option you wish to set. Logshark uses the following syntax:</p>

    <p><code class="highlighter-rouge">logshark [target] [options]</code></p>

    <p>Where <code class="highlighter-rouge">[target]</code> represents a zipped archive file (<code class="highlighter-rouge">logs.zip</code>), directory, or hash value from a previous run. Logshark supports both absolute and relative paths.
One option that you will likely use is <code class="highlighter-rouge">--startlocalmongo</code>, unless you are using your own MongoDB instance in place of the one Logshark provides.
To see all the Logshark command options and syntax, use the <code class="highlighter-rouge">--help</code> option.</p>

    <p><code class="highlighter-rouge">logshark --help</code></p>
  </li>
</ol>

<p><strong>Examples:</strong></p>

<p>The following example runs Logshark on the archive file, <code class="highlighter-rouge">logs.zip</code> and uses the local MongoDB that Logshark provides. Results are available in the *<Logshark_install_location>*`\Output` directory.</Logshark_install_location></p>

<div class="highlighter-rouge"><pre class="highlight"><code>logshark C:\Logs\logs.zip --startlocalmongo
</code></pre>
</div>

<p>The following command directs Logshark to process logs on a file share, and uses the <code class="highlighter-rouge">-p</code> option to publish the generated workbooks in the default Tableau Server location.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>logshark \\workgroup\Files\Home\Shared\logs.zip -p --startlocalmongo

</code></pre>
</div>
<p>For more information, see the <a href="#logshark-command-options">Logshark command options</a>.</p>

<h2 id="view-the-generated-tableau-workbooks">View the generated Tableau workbooks:</h2>

<ul>
  <li>
    <p>All workbooks (or other plugin-generated content) are saved in the following directory:</p>

    <p>*<Logshark_install_location>*`\Output`</Logshark_install_location></p>

    <p>You can also click <strong>Start</strong> &gt; <strong>All Programs</strong> &gt; <strong>Logshark</strong> &gt; <strong>Logshark</strong> <strong>Output</strong></p>
  </li>
  <li>
    <p>If you want to publish the workbooks to Tableau Server using the <code class="highlighter-rouge">-p</code> option, the workbooks are published on the Tableau Server you specify in the <code class="highlighter-rouge">Logshark.config</code> file. See <a href="#edit-the-tableau-server-connection-information-in-logshark.config">Edit the Tableau Server connection information in Logshark.config</a>. The URL for your workbooks would look like the following: <code class="highlighter-rouge">http://</code><em>&lt;yourServer</em>/#/site/*<yourSite>*`/projects`.
The format of a project is *<Host_Name>*`_DATETIME_`*<Filename>*, where &lt;Host\_Name&gt; is the name of the computer where Logshark was run and *<Filename>* is the name of the archive file. The project contains all the workbooks for the archive file.</Filename></Filename></Host_Name></yourSite></p>
  </li>
</ul>

<h1 id="remove-logshark-installation">Remove Logshark Installation</h1>

<p>Logshark can be removed by simply running the Logshark setup program. Temporary files, logs and workbooks generated by Logshark are left behind and must be manually deleted.</p>

<h2 id="uninstall-logshark">Uninstall Logshark</h2>

<ul>
  <li>If you want to remove Logshark from your computer, run the Logshark Setup program (<code class="highlighter-rouge">Setup\_Logshark\_v1.0.exe</code>), and then click <strong>Uninstall</strong> from the Logshark Setup dialog box.
You can also go to the Control Panel &gt; Uninstall to remove or change a program.</li>
</ul>

<h2 id="remove-postgresql-files">Remove PostgreSQL files.</h2>

<ul>
  <li>
    <p>If you want to remove PostgreSQL from your computer, go to Control Panel &gt; Uninstall or change a program and right-click your PostgreSQL program and choose <strong>Uninstall</strong>.</p>
  </li>
  <li>
    <p>Delete the data folder from PostgreSQL installation directory (for example, <code class="highlighter-rouge">C:\Windows\Program Files\PostgreSQL\9.5\data</code>).</p>
  </li>
</ul>

<h1 id="logshark-reference">Logshark Reference</h1>

<p>This section provides more information about the Logshark command and configuration options you can use to customize Logshark for your specific needs and environment.</p>

<h2 id="logshark-command-options">Logshark command options</h2>

<p>Full usage can be viewed at any time by invoking <code class="highlighter-rouge">logshark --help</code>.  The only required argument is the target, which can be either an archive (zip file), a directory, or a logset hash. A logset is a set of log files that you process at one time with Logshark. Logshark generates a hash value (checksum) for each set of logs that gets processed.</p>

<p><strong>Logshark command syntax</strong></p>

<blockquote>
  <p><strong>logshark</strong> [TARGET] [OPTIONS]…</p>
</blockquote>

<p><strong>[TARGET]</strong></p>

<p>Target can be an archive (zip) file, a hash value (from a previous Logshark run), or the path and name of a directory.</p>

<p> </p>

<table>
<thead>
<tr class="header">
<th>[OPTIONS]</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>--args [&quot;arg1”] ...</td>
<td><p>Set of custom arguments that will be passed to plugins. For example,</p>
<p>logshark --args &quot;PluginName.MyCustomArg:MyValue&quot; ...</p></td>
</tr>
<tr class="even">
<td>--dbname &lt;name&gt;</td>
<td>Sets a custom name for the database instance where plugin output is stored. If not specified, a new instance will be generated. The default behavior is to generate a new database for each run. If a name is specified and the given database name already exists, the data generated by this run will be appended to it.</td>
</tr>
<tr class="odd">
<td>-d, --dropparsedlogset</td>
<td>(Default: False) Drops the parsed logset from MongoDB at the end of the run. Logsets parsed by previous runs will be ignored.</td>
</tr>
<tr class="even">
<td>-f, --forceparse</td>
<td>(Default: False) Forces a fresh parse of the logset, overriding any existing data in MongoDB.</td>
</tr>
<tr class="odd">
<td>--listplugins</td>
<td>Lists information about all available Logshark plugins.</td>
</tr>
<tr class="even">
<td>--localmongoport &lt;port&gt;</td>
<td>(Default: 27017) Port which the temporary local MongoDB process will run on.</td>
</tr>
<tr class="odd">
<td>--metadata [&quot;key:value”] ...</td>
<td><p>Set of custom metadata key/value pairs that will stored in the resulting Mongo database. For example,</p>
<p>logshark ... --metadata &quot;SalesforceId:SomeValue TFSDefect:SomeOtherValue&quot; ...</p></td>
</tr>
<tr class="even">
<td><p>--plugins all | default | none | &lt;plugin&gt;</p>
<p>--plugins &quot;&lt;plugin1&gt; &lt;plugin2&gt; ...&quot;</p></td>
<td>(Default: default) Specifies the plugin (or list of plugins) to run against the processed log set. Also accepts &quot;all&quot; to run all plugins, or &quot;none&quot; to bypass plugin execution. To specify more than one plugin, separate the name of each plugin with a space, and enclose the list in quotation marks. See <a href="#logshark-plugins-and-generated-workbooks">Logshark plugins and generated workbooks</a>.</td>
</tr>
<tr class="odd">
<td>--parseall</td>
<td>(Default: False) Parse full logset into MongoDB. If false, only the logs required for active plugins will be parsed.</td>
</tr>
<tr class="even">
<td>-p,<br />
--publishworkbooks </td>
<td>(Default: False) Publish resulting workbooks to Tableau Server.</td>
</tr>
<tr class="odd">
<td>--projectdescription</td>
<td>Sets the Tableau Server project description where any workbooks will be published.</td>
</tr>
<tr class="even">
<td>--projectname &lt;project&gt;</td>
<td>Sets the Tableau Server project name where any workbooks will be published.</td>
</tr>
<tr class="odd">
<td>-s, --startlocalmongo </td>
<td>(Default: False) Start up a temporary local MongoDB process for this run. Recommended for small log sets only, that is, smaller than 2 GB</td>
</tr>
<tr class="even">
<td>--sitename &lt;site&gt;</td>
<td>Sets the name of the Tableau Server site where any workbooks will be published. This site must already exist and the user specified in Logshark.config must have permissions to publish and create projects in it. This value overrides the Site value specified in Logshark.config.</td>
</tr>
<tr class="odd">
<td>--tags</td>
<td>List of tags that will written to the resulting workbook(s).<br />
For example: --tags &quot;MyTag MyOtherTag&quot;</td>
</tr>
<tr class="even">
<td>--help</td>
<td>Display Logshark command help.</td>
</tr>
</tbody>
</table>

<h2 id="logshark-plugins-and-generated-workbooks">Logshark plugins and generated workbooks</h2>

<p>The following table shows the list of available Logshark plugins and the names of the workbooks that the plugins generate. Specify the name of the plugin with the Logshark <strong>–plugins</strong> option. To specify more than one plugin, use spaces to separate the plugins and enclose the list in quotation marks (“ “).</p>

<p><strong>Usage:</strong></p>

<blockquote>
  <p><strong>logshark</strong> [TARGET] <strong>–plugins</strong> &lt;<em>plugin</em>&gt;</p>

  <p><strong>logshark</strong> [TARGET] <strong>–plugins</strong> <strong>“</strong>&lt;<em>plugin1&gt; &lt;plugin2&gt; &lt;plugin3&gt; …<strong>“</strong></em></p>
</blockquote>

<p><strong>Examples:</strong></p>

<p><code class="highlighter-rouge">logshark logs.zip --plugins Apache</code></p>

<p><code class="highlighter-rouge">logshark logs.zip --plugins "Apache VizqlServer"</code></p>

<p> </p>

<table>
  <thead>
    <tr>
      <th>Plugin name</th>
      <th>Workbook</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Apache</td>
      <td>Apache.twb</td>
      <td>Collect and analyze workbook statistics on Tableau Server from the Apache (http) log files, including viz load times, view counts, errors, and warnings.  </td>
    </tr>
    <tr>
      <td>Backgrounder</td>
      <td>Backgrounder.twb</td>
      <td>Displays information about Tableau Server background tasks and jobs, such as subscriptions and extract refreshes. Data is taken from the backgrounder log files.</td>
    </tr>
    <tr>
      <td>ClusterController</td>
      <td>ClusterController.twb</td>
      <td>Displays information about Tableau Server Cluster Controller events and errors, taken from the clustercontroller &amp; zookeeper log files. Also includes some information about disk performance.</td>
    </tr>
    <tr>
      <td>Config</td>
      <td>Config.twb</td>
      <td>Displays the Tableau Server topology and configuration settings from the log files.</td>
    </tr>
    <tr>
      <td>CustomWorkbooks</td>
      <td>Any custom user workbooks in CustomWorkbooks</td>
      <td>Allows a user to output their own custom workbooks as a part of a Logshark run. These workbooks are loaded from the CustomWorkbooks\ folder. Plugin dependencies for each workbook can specified in CustomWorkbookConfig.xml. For more information, see <a href="#adding-your-own-custom-workbooks">Adding your own custom workbooks</a>.</td>
    </tr>
    <tr>
      <td>Netstat</td>
      <td>Netstat.twb</td>
      <td>Displays information about transport-layer port reservations taken from the Netstat output files in a Server logset. The ziplogs must have been taken with the <strong>–n</strong> argument in order to contain Netstat data.</td>
    </tr>
    <tr>
      <td>ResourceManager</td>
      <td>ResourceManager.twb</td>
      <td>Shows information harvested from the Server Resource Manager log events. Workbook includes metrics on CPU utilization, memory utilization, and process recycling events.</td>
    </tr>
    <tr>
      <td>Tabadmin</td>
      <td>Tabadmin.twb</td>
      <td>Displays Tableau Server admin (tabadmin) activities from the log files, including Tableau Server starts, stops, backup, and error history.</td>
    </tr>
    <tr>
      <td>VizqlDesktop</td>
      <td>VizqlDesktop.twb</td>
      <td>Collect and analyze events from Tableau Desktop vizql log files, including Vizql events, query activity, and errors.</td>
    </tr>
    <tr>
      <td>VizqlServer</td>
      <td>VizqlServer.twb</td>
      <td>Collects high-level session summary information from Tableau vizqlserver log files, including error data.</td>
    </tr>
    <tr>
      <td>VizqlServerPerformance</td>
      <td>VizqlServerPerformance.twb</td>
      <td>Collect and analyze all events from Tableau Server vizqlserver log files, including detailed performance information.</td>
    </tr>
  </tbody>
</table>

<h2 id="adding-your-own-custom-workbooks">Adding your own custom workbooks</h2>

<p>Logshark provides an option to include your own custom workbooks in a Logshark run.  These workbooks will then be included in the run output if the CustomWorkbooks plugin is run and all of their dependencies are met.</p>

<p>To configure this, first browse to your Logshark installation directory and open up the “CustomWorkbooks” folder.  This is where any custom workbook (.twb) files should be placed.  Additionally, you will need to edit CustomWorkbookConfig.xml and add an entry for your custom workbook. For example:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code> <span class="cp">&lt;!—Custom Tableau workbooks can be placed alongside this config and they will be output at runtime if their dependencies are met.
                                                                                                                                           
   Plugin dependencies must be declared for any plugins that generate a table that the custom workbook relies on.                        
                                                                                                                                           
   To get a list of eligible plugin dependency names, invoke Logshark with the "listplugins" command line flag.--!&gt;</span>                    
                                                                                                                                           
 <span class="nt">&lt;CustomWorkbooks&gt;</span>                                                                                                               
                                                                                                                                           
   <span class="nt">&lt;Workbook</span> <span class="na">name=</span><span class="s">"MyCustomApacheAndBackgrounderWorkbook.twb"</span><span class="nt">&gt;</span>                                                                
                                                                                                                                           
     <span class="nt">&lt;PluginDependency</span> <span class="na">name=</span><span class="s">"Apache"</span> <span class="nt">/&gt;</span>                                                                                              
                                                                                                                                           
     <span class="nt">&lt;PluginDependency</span> <span class="na">name=</span><span class="s">"Backgrounder"</span> <span class="nt">/&gt;</span>                                                                                        
                                                                                                                                           
   <span class="nt">&lt;/Workbook&gt;</span>                                                                                                                    
                                                                                                                                           
 <span class="nt">&lt;/CustomWorkbooks&gt;</span>                                                                                                            
</code></pre>
</div>

<p>This entry will cause the file <code class="highlighter-rouge">MyCustomApacheAndBackgrounderWorkbook.twb</code> to be output at the Logshark run with the appropriate data sources substituted.  NOTE: The <code class="highlighter-rouge">PluginDependency</code> entries in the example above will make it so that the workbook will only be output if both the Apache and Backgrounder plugins run successfully.  You can declare multiple plugin dependencies for a single workbook, so that you can include workbooks that join the output tables of multiple plugins.</p>

<h2 id="appending-logshark-generated-data-to-the-same-workbook">Appending Logshark-generated data to the same workbook</h2>

<p>When you run Logshark using the default command options, Logshark generates a new PostgreSQL database for each run. If you want to append data to the same database, so that the data will all be available in the same workbook, you can specify the name of the database on the command line, using the <code class="highlighter-rouge">--dbname</code> <em>&lt;database&gt;</em> option. You can use this option to set a custom name for the database where the plugin output is stored (the data source for the plugin workbook).</p>

<div class="highlighter-rouge"><pre class="highlight"><code>logshark C:\\Logs\\logs.zip --plugins Apache --dbname myApacheData`
</code></pre>
</div>

<p>If the <code class="highlighter-rouge">–-dbname</code> option is not specified, a new database will be generated.</p>

<h2 id="use-your-own-mongodb-instance">Use your own MongoDB instance</h2>

<p>If you have log files that are larger than 2 GB, you should install and set up your own MongoDB Community server. Download it from <a href="https://www.mongodb.com/download-center">https://www.mongodb.com/download-center#community.
</a></p>

<p>If you install your own MongoDB, you must configure Logshark to use your MongoDB instance by editing the Logshark configuration file, <em>&lt;Logshark_install_location&gt;</em><code class="highlighter-rouge">\config\Logshark.config</code>.</p>

<p>The Logshark.config file contains the <code class="highlighter-rouge">&lt;MongoConnection&gt;</code> element that sets the options for the MongoDB that Logshark uses to store the BSON documents extracted from the archive (zipped logs).</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code>  <span class="nt">&lt;MongoConnection</span> <span class="na">poolSize=</span><span class="s">"200"</span> <span class="na">timeout=</span><span class="s">"60"</span> <span class="na">insertionRetries=</span><span class="s">"3"</span><span class="nt">&gt;</span> 
    <span class="nt">&lt;Server</span> <span class="na">address=</span><span class="s">"logshark-mongo-prod"</span> <span class="na">port=</span><span class="s">"27000"</span><span class="nt">/&gt;</span> 
    <span class="nt">&lt;User</span> <span class="na">username=</span><span class="s">"logshark"</span> <span class="na">password=</span><span class="s">"logshark"</span><span class="nt">/&gt;</span> 
  <span class="nt">&lt;/MongoConnection&gt;</span> 
</code></pre>
</div>

<p>If you want to use a different MongoDB, change the setting for server address and port to match the new database. 
For example:</p>

<p><code class="highlighter-rouge">&lt;Server address="myMongodb_server" port="27017"/&gt;</code></p>

<p>Set the user name and password, if necessary, or leave blank:</p>

<p><code class="highlighter-rouge">&lt;User username="" password=""/&gt;</code></p>

<p>The MongoConnection element has attributes that describe the connection properties. These attributes are described in the following table:</p>

<table>
  <thead>
    <tr>
      <th>MongoConnection Attribute</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>poolSize</td>
      <td>Sets the maximum connection pool size for concurrent connections to MongoDB.  Most people will never come close to reaching the default limit of 200. If you experience problems with having too many concurrent connections open against the MongoDB, you might want to try lowering this value. The default is <code class="highlighter-rouge">poolSize="200"</code>.</td>
    </tr>
    <tr>
      <td>timeout  </td>
      <td>Specifies the maximum time to wait (in seconds) when the client is establishing a new connection to MongoDB.  In most cases, you won’t want to change this, as the default setting of 60 seconds should allow plenty of time. Default is <code class="highlighter-rouge">timeout="60"</code>.</td>
    </tr>
    <tr>
      <td>insertionRetries</td>
      <td>Specifies the number of times a failed insertion to MongoDB will be retried.  Retries are costly operations, so the number of attempts probably shouldn’t ever be set higher than the default (<code class="highlighter-rouge">insertionRetries="3"</code>).</td>
    </tr>
  </tbody>
</table>
